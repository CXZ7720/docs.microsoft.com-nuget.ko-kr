---
title: 플러그 인 플랫폼 간 NuGet
description: NuGet은 NuGet.exe "," dotnet.exe "," msbuild.exe "및" Visual Studio에 대 한 플러그 인 플랫폼 간
author: nkolev92
ms.author: nikolev
ms.date: 07/01/2018
ms.topic: conceptual
ms.openlocfilehash: fdefc5b6189051fd83b2de644080284c09dd85f4
ms.sourcegitcommit: 1d1406764c6af5fb7801d462e0c4afc9092fa569
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 09/04/2018
ms.locfileid: "43548208"
---
# <a name="nuget-cross-platform-plugins"></a>플러그 인 플랫폼 간 NuGet

NuGet 4.8 이상에서 크로스 플랫폼 플러그 인에 대 한 지원이 추가 되었습니다.
이 작업이 엄격한 규칙 작업의 집합을 준수 하는 새 플러그 인 확장성 모델을 작성 하 여 사용 하 여 수행 되었습니다.
플러그 인은 NuGet 클라이언트는 별도의 프로세스로 시작 하는 자체 포함 된 실행 파일 (.NET Core 환경에서 runnables).
이것이 true 쓰기를 한 번 실행 everywhere 플러그 인입니다. 모든 NuGet 클라이언트 도구를 사용 하 여 작동 합니다.
플러그 인 (NuGet.exe, MSBuild.exe 및 Visual Studio)에서.NET Framework 또는.NET Core (dotnet.exe) 수 있습니다.
NuGet 클라이언트와 플러그 인 버전 통신 프로토콜 정의 됩니다. 시작 핸드셰이크 중 2 프로세스 프로토콜 버전을 협상합니다.

모든 NuGet 클라이언트 도구 시나리오를 처리 하기 위해.NET Framework 및.NET Core 플러그 인을 하나이 해야 합니다.
클라이언트/프레임 워크에 대 한 조합을 플러그 인에 설명 합니다.

| 클라이언트 도구  | 프레임워크 |
| ------------ | --------- |
| Visual Studio | .NET Framework |
| dotnet.exe | .NET Core |
| NuGet.exe | .NET Framework |
| MSBuild.exe | .NET Framework |
| Mono에서 NuGet.exe | .NET Framework |

## <a name="how-does-it-work"></a>어떻게 작동 하나요

높은 수준의 워크플로 다음과 같이 설명할 수 있습니다.

1. NuGet은 사용 가능한 플러그 인을 검색합니다.
1. 해당 하는 경우 NuGet 하나씩 시작 및 우선 순위 순서 대로 플러그 인 반복 됩니다.
1. NuGet은 요청을 처리할 수 있는 첫 번째 플러그 인을 사용 합니다.
1. 플러그 인 종료 됩니다. 더 이상 필요 없는 경우.

## <a name="general-plugin-requirements"></a>일반 플러그 인 요구 사항

현재 프로토콜 버전이 *2.0.0*합니다.
이 버전에서 요구 사항은 다음과 같습니다.

- 신뢰할 수 있는 유효한 Authenticode 서명을 어셈블리를 Windows 및 Mono에서 실행 되는 경우 Linux 및 Mac에서 아직 실행 되는 어셈블리에 대 한 특별 한 신뢰 요건은 없습니다. [관련 문제](https://github.com/NuGet/Home/issues/6702)
- NuGet 클라이언트 도구의 현재 보안 컨텍스트 내에서 상태 비저장 시작을 지원 합니다. 예를 들어, NuGet 클라이언트 도구는 권한 상승 또는 나중에 설명 된 플러그 인 프로토콜 외부의 추가 초기화 수행 하지 않습니다.
- 명시적으로 지정 되지 않은 경우 비 대화형를 수 있습니다.
- 플러그 인 협상 된 프로토콜 버전을 준수 합니다.
- 적절 한 기간 내에서 모든 요청에 응답 합니다.
- 모든 진행 중인 작업에 대 한 취소 요청을 인식 합니다.

기술 사양은 다음 사양에 자세히 설명 되어 있습니다.

- [NuGet 패키지 다운로드 플러그 인](https://github.com/NuGet/Home/wiki/NuGet-Package-Download-Plugin)
- [구획 인증 플러그 인 간 NuGet](https://github.com/NuGet/Home/wiki/NuGet-cross-plat-authentication-plugin)

## <a name="client---plugin-interaction"></a>클라이언트-플러그 인 상호 작용

NuGet 클라이언트 도구와 플러그 인 표준 스트림 (stdin, stdout, stderr)을 통해 JSON을 사용 하 여 통신합니다. 모든 데이터는 u t F-8로 인코딩된 이어야 합니다.
플러그 인 인수를 사용 하 여 시작 "-플러그 인"입니다. 사용자 플러그 인이이 인수 없이 실행 파일을 직접 시작 하는 경우 플러그 인 프로토콜 핸드셰이크를 기다리는 대신 정보 메시지를 제공할 수 있습니다.
프로토콜 핸드셰이크 제한 시간은 5 초입니다. 플러그 인을 최대한 용량 부족으로 설치를 완료 해야 합니다.
NuGet 클라이언트 도구는 NuGet 소스에 대 한 서비스 인덱스를 전달 하 여 플러그 인의 지원 되는 작업을 조회 합니다. 플러그 인에 지원 되는 서비스 형식의 현재 상태를 확인할 서비스 인덱스를 사용할 수 있습니다.

NuGet 클라이언트 도구 및 플러그 인 간의 통신은 양방향입니다. 각 요청에 5 초의 제한 시간입니다. 작업은 시간이 오래 걸릴 간주 하는 경우 해당 프로세스는 요청 시간 초과 되지 않도록 하려면 진행률 메시지 전송 해야 합니다. 전까지 비활성 시간 1 분 후 플러그 인을 유휴 간주 되 고 종료 됩니다.

## <a name="plugin-installation-and-discovery"></a>플러그 인 설치 및 검색

플러그 인 기반 규칙 디렉터리 구조를 통해 검색 됩니다.
CI/CD 시나리오 및 고급 사용자 동작을 재정의 하는 환경 변수를 사용할 수 있습니다.

- `NUGET_PLUGIN_PATHS` -해당 NuGet 프로세스를 예약 하는 우선 순위에 사용할 플러그 인을 정의 합니다. 이 환경 변수를 설정 하는 경우 규칙 기반 검색을 재정의 합니다.
-  사용자 위치, NuGet 홈 위치 `%UserProfile%/.nuget/plugins`합니다. 이 위치는 재정의할 수 없습니다. .NET Core와.NET Framework 플러그 인에 대 한 다른 루트 디렉터리가 사용 됩니다.

| 프레임워크 | 루트 검색 위치  |
| ------- | ------------------------ |
| .NET Core |  `%UserProfile%/.nuget/plugins/netcore` |
| .NET Framework | `%UserProfile%/.nuget/plugins/netfx` |

각 플러그 인 폴더에 설치 되어야 합니다.
플러그 인 진입점에는.NET Core 용.dll 확장명 및.NET Framework에 대 한.exe 확장명을 사용 하 여 설치 된 폴더의 이름이 됩니다.

```
.nuget
    plugins
        netfx
            myPlugin
                myPlugin.exe
                nuget.protocol.dll
                ...
        netcore
            myPlugin
                myPlugin.dll
                nuget.protocol.dll
                ...
```

> [!Note]
> 현재 플러그 인 설치에 없는 사용자 스토리가입니다. 미리 결정 된 위치에 필요한 파일을 이동 하는 것으로 간단 합니다.

## <a name="supported-operations"></a>지원 되는 작업

두 작업은 새 플러그 인 프로토콜에서 지원 됩니다.

| 작업 이름 | 최소 프로토콜 버전 | 최소 NuGet 클라이언트 버전 |
| -------------- | ----------------------- | --------------------- |
| 패키지를 다운로드 합니다. | 1.0.0 | 4.3.0 |
| [인증](NuGet-Cross-Platform-Authentication-Plugin.md) | 2.0.0 | 4.8.0 |

## <a name="running-plugins-under-the-correct-runtime"></a>올바른 런타임에서 플러그 인 실행

Dotnet.exe 시나리오의 NuGet, 플러그 인을 dotnet.exe의 해당 특정 런타임 실행 하려면 필요 합니다.
호환 dotnet.exe/plugin 결합 하 여 사용할 되도록 플러그 인 공급자와 소비자입니다.
예를 들어 하는 경우 사용자 위치 플러그 인을 사용 하 여 잠재적인 문제를 발생할 수 있습니다, 그리고 2.0 런타임에서 dotnet.exe 2.1 런타임용으로 작성 하는 플러그 인을 사용 하려고 합니다.

## <a name="capabilities-caching"></a>캐싱 기능

보안 확인 및 플러그 인의 인스턴스화 비용이 많이 듭니다. 다운로드 작업 평균 NuGet 사용자가 인증 하는 플러그 인을 갖고 있지만 인증 작업을 보다 훨씬 더 자주 발생 합니다.
환경을 개선 하기 위해 NuGet에는 지정된 된 요청에 대 한 작업 클레임을 캐시 합니다. 이 캐시 플러그 인당 플러그 인 경로 플러그 인 키를 사용 하 여 이며이 기능 캐시의 만료 30 일입니다. 

캐시에 위치한 `%LocalAppData%/NuGet/plugins-cache` 환경 변수를 사용 하 여 재정의할 수 및 `NUGET_PLUGINS_CACHE_PATH`합니다. 이 지우려면 [캐시](../../consume-packages/managing-the-global-packages-and-cache-folders.md), 지역 변수를 실행할 수 있는 명령과 `plugins-cache` 옵션입니다.
`all` 이제 지역 옵션 플러그 인 캐시도 삭제 됩니다. 

## <a name="protocol-messages-index"></a>프로토콜 메시지 인덱스

프로토콜 버전 *1.0.0* 메시지:

1.  닫기
    * 방향 요청: NuGet-플러그 인 >
    * 요청 페이로드 없이 포함 됩니다.
    * 응답이 필요 합니다.  즉시 종료 하는 플러그 인 프로세스에 대 한 적절 한 응답이입니다.

2.  패키지의 파일 복사
    * 방향 요청: NuGet-플러그 인 >
    * 요청이 포함 됩니다.
        * 패키지 ID 및 버전
        * 패키지 원본 리포지토리 위치
        * 대상 디렉터리 경로
        * 대상 디렉터리 경로 복사할 대상 패키지의 파일 열거
    * 응답에 포함 됩니다.
        * 작업의 결과 나타내는 응답 코드
        * 열거 가능한 작업에 성공 하는 경우 대상 디렉터리에 복사한 파일의 전체 경로

3.  패키지 파일 (.nupkg)를 복사 합니다.
    * 방향 요청: NuGet-플러그 인 >
    * 요청이 포함 됩니다.
        * 패키지 ID 및 버전
        * 패키지 원본 리포지토리 위치
        * 대상 파일 경로
    * 응답에 포함 됩니다.
        * 작업의 결과 나타내는 응답 코드

4.  자격 증명 가져오기
    * 방향 요청: 플러그 인에는 NuGet->
    * 요청이 포함 됩니다.
        * 패키지 원본 리포지토리 위치
        * 현재 자격 증명을 사용 하 여 패키지 원본 저장소에서 가져온 HTTP 상태 코드
    * 응답에 포함 됩니다.
        * 작업의 결과 나타내는 응답 코드
        * 사용 가능한 경우 사용자 이름
        * 암호를 사용할 수 있는 경우

5.  패키지의 파일
    * 방향 요청: NuGet-플러그 인 >
    * 요청이 포함 됩니다.
        * 패키지 ID 및 버전
        * 패키지 원본 리포지토리 위치
    * 응답에 포함 됩니다.
        * 작업의 결과 나타내는 응답 코드
        * 열거 작업에 성공 하는 경우 패키지의 파일 경로

6.  작업 클레임 가져오기 
    * 방향 요청: NuGet-플러그 인 >
    * 요청이 포함 됩니다.
        * 패키지 원본에 대 한 서비스 index.json
        * 패키지 원본 리포지토리 위치
    * 응답에 포함 됩니다.
        * 작업의 결과 나타내는 응답 코드
        * 열거 가능한 지원 되는 작업 (예: 패키지 다운로드) 작업에 성공 하는 경우.  플러그 인 패키지 소스를 지원 하지 않는 경우 플러그 인에 지원 되는 작업의 빈 집합을 반환 해야 합니다.

> [!Note]
> 이 메시지 버전에서 업데이트 되었습니다 *2.0.0*합니다. 이전 버전과 호환성을 유지 하기 위해 클라이언트입니다.

7.  패키지 해시를 가져오려면
    * 방향 요청: NuGet-플러그 인 >
    * 요청이 포함 됩니다.
        * 패키지 ID 및 버전
        * 패키지 원본 리포지토리 위치
        * 해시 알고리즘
    * 응답에 포함 됩니다.
        * 작업의 결과 나타내는 응답 코드
        * 작업에 성공 하는 경우 요청 된 해시 알고리즘을 사용 하 여 패키지 파일 해시

8.  패키지 버전 가져오기
    * 방향 요청: NuGet-플러그 인 >
    * 요청이 포함 됩니다.
        * 패키지 ID
        * 패키지 원본 리포지토리 위치
    * 응답에 포함 됩니다.
        * 작업의 결과 나타내는 응답 코드
        * 열거 가능한 작업에 성공 하는 경우 패키지 버전

9.  서비스 인덱스 가져오기
    * 방향 요청: 플러그 인에는 NuGet->
    * 요청이 포함 됩니다.
        * 패키지 원본 리포지토리 위치
    * 응답에 포함 됩니다.
        * 작업의 결과 나타내는 응답 코드
        * 서비스 인덱스 작업에 성공 하는 경우

10.  핸드셰이크
     * 방향 요청: NuGet <>-플러그 인
     * 요청이 포함 됩니다.
         * 현재 플러그 인 프로토콜 버전
         * 지원 되는 플러그 인을 최소 프로토콜 버전
     * 응답에 포함 됩니다.
         * 작업의 결과 나타내는 응답 코드
         * 작업에 성공 하는 경우 협상 된 프로토콜 버전입니다.  플러그 인 종료 오류가 발생 합니다.

11.  초기화
     * 방향 요청: NuGet-플러그 인 >
     * 요청이 포함 됩니다.
         * NuGet 클라이언트 도구 버전
         * NuGet 클라이언트 도구 효과적인 언어입니다.  이 고려 ForceEnglishOutput 설정을 사용 하는 경우.
         * 기본 요청 제한 시간이 프로토콜 기본 대체 합니다.
     * 응답에 포함 됩니다.
         * 작업의 결과 나타내는 응답 코드입니다.  플러그 인 종료 오류가 발생 합니다.

12.  로그
     * 방향 요청: 플러그 인에는 NuGet->
     * 요청이 포함 됩니다.
         * 요청에 대 한 로그 수준
         * 기록할 메시지
     * 응답에 포함 됩니다.
         * 작업의 결과 나타내는 응답 코드입니다.

13.  NuGet 프로세스 종료를 모니터링 합니다.
     * 방향 요청: NuGet-플러그 인 >
     * 요청이 포함 됩니다.
         * NuGet 프로세스 ID
     * 응답에 포함 됩니다.
         * 작업의 결과 나타내는 응답 코드입니다.

14.  패키지를 사전 인출
     * 방향 요청: NuGet-플러그 인 >
     * 요청이 포함 됩니다.
         * 패키지 ID 및 버전
         * 패키지 원본 리포지토리 위치
     * 응답에 포함 됩니다.
         * 작업의 결과 나타내는 응답 코드

15.  자격 증명 설정
     * 방향 요청: NuGet-플러그 인 >
     * 요청이 포함 됩니다.
         * 패키지 원본 리포지토리 위치
         * 마지막으로 알려진된 패키지 원본 사용자 이름, 사용 가능한 경우
         * 마지막으로 알려진된 패키지 소스 암호를 사용할 수 있는 경우
         * 마지막으로 알려진된 프록시 사용자 이름, 사용 가능한 경우
         * 마지막으로 알려진된 프록시 암호를 사용할 수 있는 경우
     * 응답에 포함 됩니다.
         * 작업의 결과 나타내는 응답 코드

16.  로그 수준 설정
     * 방향 요청: NuGet-플러그 인 >
     * 요청이 포함 됩니다.
         * 기본 로그 수준
     * 응답에 포함 됩니다.
         * 작업의 결과 나타내는 응답 코드

프로토콜 버전 *2.0.0* 메시지

17. 작업 클레임 가져오기

* 방향 요청: NuGet-플러그 인 >
    * 요청이 포함 됩니다.
        * 패키지 원본에 대 한 서비스 index.json
        * 패키지 원본 리포지토리 위치
    * 응답에 포함 됩니다.
        * 작업의 결과 나타내는 응답 코드
        * 열거 작업에 성공 하는 경우 지원 되는 작업입니다.  플러그 인 패키지 소스를 지원 하지 않는 경우 플러그 인에 지원 되는 작업의 빈 집합을 반환 해야 합니다.

    서비스 인덱스와 패키지 원본 null 인 경우에 인증을 사용 하 여 플러그 인 답변할 수 있습니다.

18. 인증 자격 증명 가져오기

* 방향 요청: NuGet-플러그 인 >
* 요청이 포함 됩니다.
    * URI
    * isRetry
    * NonInteractive
    * CanShowDialog
* 응답에 포함 됩니다.
    * 사용자 이름
    * 암호
    * 메시지
    * 인증 유형 목록
    * MessageResponseCode